947f0529158e4f6ffb1d14a7a05be3de
// @ts-nocheck
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get AdvancedRateLimiter () {
        return AdvancedRateLimiter;
    },
    get advancedRateLimiter () {
        return advancedRateLimiter;
    }
});
const _events = require("events");
class AdvancedRateLimiter extends _events.EventEmitter {
    constructor(){
        super(), this.stores = new Map(), this.rules = new Map(), this.globalLimits = new Map(), this.whitelistedIPs = new Set(), this.blacklistedIPs = new Set(), this.suspiciousActivity = new Map();
        this.initializeDefaultRules();
        this.startCleanupTimer();
    }
    // Main rate limiting function
    async checkLimit(request) {
        const identifier = this.getIdentifier(request);
        // Check blacklist first
        if (this.blacklistedIPs.has(request.ip)) {
            return {
                allowed: false,
                reason: 'IP_BLACKLISTED',
                resetTime: Date.now() + 3600000,
                retryAfter: 3600
            };
        }
        // Check whitelist - bypass rate limits
        if (this.whitelistedIPs.has(request.ip)) {
            return {
                allowed: true,
                reason: 'WHITELISTED',
                remaining: Infinity,
                resetTime: Date.now() + 3600000
            };
        }
        // Get applicable rules
        const rules = this.getRulesForRequest(request);
        // Check each rule
        for (const rule of rules){
            const result = await this.checkRule(rule, identifier, request);
            if (!result.allowed) {
                // Track failed attempts for suspicious activity detection
                this.trackSuspiciousActivity(request.ip, rule);
                // Emit rate limit event
                this.emit('rateLimit:exceeded', {
                    rule: rule.name,
                    identifier,
                    request,
                    result
                });
                return result;
            }
        }
        // Check global limits
        const globalResult = await this.checkGlobalLimits(request);
        if (!globalResult.allowed) {
            return globalResult;
        }
        // All checks passed - record the request
        await this.recordRequest(identifier, request);
        // Get remaining count for the most restrictive rule
        const remaining = await this.getRemainingCount(rules, identifier);
        return {
            allowed: true,
            remaining,
            resetTime: Date.now() + Math.min(...rules.map((r)=>r.window))
        };
    }
    // Add custom rate limit rule
    addRule(rule) {
        const endpoint = rule.endpoint || '*';
        if (!this.rules.has(endpoint)) {
            this.rules.set(endpoint, []);
        }
        this.rules.get(endpoint).push(rule);
        // Sort rules by priority (higher first)
        this.rules.get(endpoint).sort((a, b)=>(b.priority || 0) - (a.priority || 0));
    }
    // Dynamic rate limiting based on system load
    async adjustLimitsBasedOnLoad() {
        const systemLoad = await this.getSystemLoad();
        const dbLoad = await this.getDatabaseLoad();
        // Reduce limits if system is under high load
        if (systemLoad > 80 || dbLoad > 80) {
            this.applyLoadBasedLimits(0.5); // Reduce by 50%
            this.emit('rateLimit:loadAdjustment', {
                systemLoad,
                dbLoad,
                factor: 0.5
            });
        } else if (systemLoad > 60 || dbLoad > 60) {
            this.applyLoadBasedLimits(0.75); // Reduce by 25%
            this.emit('rateLimit:loadAdjustment', {
                systemLoad,
                dbLoad,
                factor: 0.75
            });
        } else {
            this.applyLoadBasedLimits(1.0); // Normal limits
        }
    }
    // Sliding window rate limiting
    async slidingWindowCheck(rule, identifier) {
        const store = this.getStore(rule.name);
        const now = Date.now();
        const windowStart = now - rule.window;
        // Get requests in the current window
        const requests = store.getRequestsInWindow(identifier, windowStart, now);
        if (requests.length >= rule.limit) {
            const oldestRequest = Math.min(...requests);
            const resetTime = oldestRequest + rule.window;
            return {
                allowed: false,
                reason: 'RATE_LIMIT_EXCEEDED',
                resetTime,
                retryAfter: Math.ceil((resetTime - now) / 1000),
                limit: rule.limit,
                remaining: 0
            };
        }
        return {
            allowed: true,
            remaining: rule.limit - requests.length - 1,
            resetTime: now + rule.window
        };
    }
    // Token bucket rate limiting
    async tokenBucketCheck(rule, identifier) {
        const store = this.getStore(rule.name);
        const bucket = store.getTokenBucket(identifier) || {
            tokens: rule.limit,
            lastRefill: Date.now()
        };
        const now = Date.now();
        const timePassed = now - bucket.lastRefill;
        const tokensToAdd = Math.floor(timePassed / (rule.window / rule.limit));
        // Refill tokens
        bucket.tokens = Math.min(rule.limit, bucket.tokens + tokensToAdd);
        bucket.lastRefill = now;
        if (bucket.tokens < 1) {
            const refillTime = bucket.lastRefill + rule.window / rule.limit;
            return {
                allowed: false,
                reason: 'RATE_LIMIT_EXCEEDED',
                resetTime: refillTime,
                retryAfter: Math.ceil((refillTime - now) / 1000),
                remaining: 0
            };
        }
        // Consume token
        bucket.tokens -= 1;
        store.setTokenBucket(identifier, bucket);
        return {
            allowed: true,
            remaining: Math.floor(bucket.tokens),
            resetTime: now + rule.window
        };
    }
    // Fixed window rate limiting
    async fixedWindowCheck(rule, identifier) {
        const store = this.getStore(rule.name);
        const now = Date.now();
        const windowStart = Math.floor(now / rule.window) * rule.window;
        const windowKey = `${identifier}:${windowStart}`;
        const count = store.getWindowCount(windowKey) || 0;
        if (count >= rule.limit) {
            const resetTime = windowStart + rule.window;
            return {
                allowed: false,
                reason: 'RATE_LIMIT_EXCEEDED',
                resetTime,
                retryAfter: Math.ceil((resetTime - now) / 1000),
                remaining: 0
            };
        }
        // Increment counter
        store.incrementWindowCount(windowKey, rule.window);
        return {
            allowed: true,
            remaining: rule.limit - count - 1,
            resetTime: windowStart + rule.window
        };
    }
    // Distributed rate limiting for multi-server setups
    async distributedCheck(rule, identifier) {
        if (!rule.distributed) {
            throw new Error('Rule is not configured for distributed rate limiting');
        }
        // Use Redis or similar for distributed state
        const distributedStore = await this.getDistributedStore();
        const key = `rate_limit:${rule.name}:${identifier}`;
        const pipeline = distributedStore.pipeline();
        pipeline.incr(key);
        pipeline.expire(key, Math.ceil(rule.window / 1000));
        const results = await pipeline.exec();
        const count = results[0][1];
        if (count > rule.limit) {
            const ttl = await distributedStore.ttl(key);
            const resetTime = Date.now() + ttl * 1000;
            return {
                allowed: false,
                reason: 'RATE_LIMIT_EXCEEDED',
                resetTime,
                retryAfter: ttl,
                remaining: 0
            };
        }
        return {
            allowed: true,
            remaining: rule.limit - count,
            resetTime: Date.now() + rule.window
        };
    }
    // Adaptive rate limiting based on user behavior
    async adaptiveCheck(rule, identifier, request) {
        const userProfile = await this.getUserProfile(identifier);
        // Adjust limits based on user tier
        let adjustedLimit = rule.limit;
        switch(userProfile.tier){
            case 'premium':
                adjustedLimit *= 2;
                break;
            case 'enterprise':
                adjustedLimit *= 5;
                break;
            case 'free':
                adjustedLimit *= 0.5;
                break;
        }
        // Adjust based on user reputation
        if (userProfile.reputation > 0.8) {
            adjustedLimit *= 1.5;
        } else if (userProfile.reputation < 0.3) {
            adjustedLimit *= 0.5;
        }
        // Create adjusted rule
        const adjustedRule = {
            ...rule,
            limit: Math.floor(adjustedLimit)
        };
        return this.slidingWindowCheck(adjustedRule, identifier);
    }
    // IP-based geographic rate limiting
    async geographicCheck(rule, request) {
        if (!rule.geographic) return {
            allowed: true
        };
        const location = await this.getIPLocation(request.ip);
        const geoRule = rule.geographic[location.country] || rule.geographic.default;
        if (!geoRule) return {
            allowed: true
        };
        const adjustedRule = {
            ...rule,
            ...geoRule
        };
        return this.slidingWindowCheck(adjustedRule, request.ip);
    }
    // Burst protection
    async burstProtectionCheck(rule, identifier) {
        if (!rule.burstProtection) return {
            allowed: true
        };
        const store = this.getStore(rule.name);
        const now = Date.now();
        const burstWindow = rule.burstProtection.window || 1000; // 1 second default
        const burstLimit = rule.burstProtection.limit || 5;
        const recentRequests = store.getRequestsInWindow(identifier, now - burstWindow, now);
        if (recentRequests.length >= burstLimit) {
            return {
                allowed: false,
                reason: 'BURST_LIMIT_EXCEEDED',
                resetTime: now + burstWindow,
                retryAfter: Math.ceil(burstWindow / 1000)
            };
        }
        return {
            allowed: true
        };
    }
    // Whitelist/Blacklist management
    addToWhitelist(ip) {
        this.whitelistedIPs.add(ip);
        this.emit('whitelist:added', {
            ip
        });
    }
    removeFromWhitelist(ip) {
        this.whitelistedIPs.delete(ip);
        this.emit('whitelist:removed', {
            ip
        });
    }
    addToBlacklist(ip, duration) {
        this.blacklistedIPs.add(ip);
        this.emit('blacklist:added', {
            ip,
            duration
        });
        if (duration) {
            setTimeout(()=>{
                this.removeFromBlacklist(ip);
            }, duration);
        }
    }
    removeFromBlacklist(ip) {
        this.blacklistedIPs.delete(ip);
        this.emit('blacklist:removed', {
            ip
        });
    }
    // Suspicious activity detection
    trackSuspiciousActivity(ip, rule) {
        const activity = this.suspiciousActivity.get(ip) || {
            violations: 0,
            firstViolation: Date.now(),
            lastViolation: Date.now(),
            rules: new Set()
        };
        activity.violations++;
        activity.lastViolation = Date.now();
        activity.rules.add(rule.name);
        this.suspiciousActivity.set(ip, activity);
        // Auto-blacklist after threshold
        if (activity.violations >= 10) {
            this.addToBlacklist(ip, 3600000); // 1 hour
            this.emit('security:autoBlacklist', {
                ip,
                activity
            });
        }
    }
    // Get rate limit statistics
    async getStatistics(timeRange = '1h') {
        const stats = {
            totalRequests: 0,
            blockedRequests: 0,
            topBlockedIPs: [],
            topBlockedEndpoints: [],
            rules: []
        };
        // Aggregate statistics from all stores
        for (const [ruleName, store] of this.stores){
            const ruleStats = store.getStatistics(timeRange);
            stats.totalRequests += ruleStats.totalRequests;
            stats.blockedRequests += ruleStats.blockedRequests;
            stats.rules.push({
                name: ruleName,
                ...ruleStats
            });
        }
        return stats;
    }
    // Private helper methods
    initializeDefaultRules() {
        // Global API rate limit
        this.addRule({
            name: 'global_api',
            endpoint: '/api/*',
            limit: 1000,
            window: 3600000,
            algorithm: 'sliding_window',
            priority: 1
        });
        // Authentication endpoints
        this.addRule({
            name: 'auth_strict',
            endpoint: '/api/auth/*',
            limit: 5,
            window: 900000,
            algorithm: 'fixed_window',
            priority: 10,
            burstProtection: {
                limit: 3,
                window: 60000 // 1 minute
            }
        });
        // Upload endpoints
        this.addRule({
            name: 'upload_limit',
            endpoint: '/api/upload',
            limit: 50,
            window: 3600000,
            algorithm: 'token_bucket',
            priority: 5
        });
        // Email campaign endpoints
        this.addRule({
            name: 'email_campaigns',
            endpoint: '/api/email-campaigns/*',
            limit: 100,
            window: 3600000,
            algorithm: 'sliding_window',
            priority: 3
        });
    }
    getIdentifier(request) {
        // Use user ID if authenticated, otherwise IP
        return request.userId || request.ip;
    }
    getRulesForRequest(request) {
        const matchingRules = [];
        for (const [endpoint, rules] of this.rules){
            if (this.endpointMatches(endpoint, request.endpoint)) {
                matchingRules.push(...rules);
            }
        }
        return matchingRules.sort((a, b)=>(b.priority || 0) - (a.priority || 0));
    }
    endpointMatches(pattern, endpoint) {
        if (pattern === '*') return true;
        if (pattern === endpoint) return true;
        // Simple wildcard matching
        const regex = new RegExp('^' + pattern.replace(/\*/g, '.*') + '$');
        return regex.test(endpoint);
    }
    async checkRule(rule, identifier, request) {
        // Check burst protection first
        const burstResult = await this.burstProtectionCheck(rule, identifier);
        if (!burstResult.allowed) return burstResult;
        // Check geographic restrictions
        const geoResult = await this.geographicCheck(rule, request);
        if (!geoResult.allowed) return geoResult;
        // Apply the main algorithm
        switch(rule.algorithm){
            case 'sliding_window':
                return this.slidingWindowCheck(rule, identifier);
            case 'token_bucket':
                return this.tokenBucketCheck(rule, identifier);
            case 'fixed_window':
                return this.fixedWindowCheck(rule, identifier);
            case 'adaptive':
                return this.adaptiveCheck(rule, identifier, request);
            case 'distributed':
                return this.distributedCheck(rule, identifier);
            default:
                return this.slidingWindowCheck(rule, identifier);
        }
    }
    async checkGlobalLimits(request) {
        // Check global IP limit
        const ipLimit = this.globalLimits.get('ip_global');
        if (ipLimit) {
            const store = this.getStore('global_ip');
            const requests = store.getRequestsInWindow(request.ip, Date.now() - ipLimit.window, Date.now());
            if (requests.length >= ipLimit.limit) {
                return {
                    allowed: false,
                    reason: 'GLOBAL_IP_LIMIT_EXCEEDED',
                    resetTime: Date.now() + ipLimit.window,
                    retryAfter: Math.ceil(ipLimit.window / 1000)
                };
            }
        }
        return {
            allowed: true
        };
    }
    getStore(name) {
        if (!this.stores.has(name)) {
            this.stores.set(name, new InMemoryRateLimitStore());
        }
        return this.stores.get(name);
    }
    async recordRequest(identifier, request) {
        // Record in all applicable stores
        const rules = this.getRulesForRequest(request);
        for (const rule of rules){
            const store = this.getStore(rule.name);
            store.recordRequest(identifier, Date.now());
        }
    }
    async getRemainingCount(rules, identifier) {
        let minRemaining = Infinity;
        for (const rule of rules){
            const result = await this.checkRule(rule, identifier, {});
            if (result.remaining !== undefined && result.remaining < minRemaining) {
                minRemaining = result.remaining;
            }
        }
        return minRemaining === Infinity ? 0 : minRemaining;
    }
    applyLoadBasedLimits(factor) {
        for (const [endpoint, rules] of this.rules){
            rules.forEach((rule)=>{
                if (!rule.originalLimit) {
                    rule.originalLimit = rule.limit;
                }
                rule.limit = Math.floor(rule.originalLimit * factor);
            });
        }
    }
    startCleanupTimer() {
        setInterval(()=>{
            this.cleanup();
        }, 300000); // 5 minutes
    }
    cleanup() {
        const now = Date.now();
        const cleanupAge = 3600000; // 1 hour
        // Clean up old suspicious activity records
        for (const [ip, activity] of this.suspiciousActivity){
            if (now - activity.lastViolation > cleanupAge) {
                this.suspiciousActivity.delete(ip);
            }
        }
        // Clean up store data
        for (const store of this.stores.values()){
            store.cleanup();
        }
    }
    // Mock implementations for external services
    async getSystemLoad() {
        return Math.random() * 100;
    }
    async getDatabaseLoad() {
        return Math.random() * 100;
    }
    async getDistributedStore() {
        // Mock Redis client
        return {
            pipeline: ()=>({
                    incr: ()=>{},
                    expire: ()=>{},
                    exec: ()=>Promise.resolve([
                            [
                                null,
                                1
                            ]
                        ])
                }),
            ttl: ()=>Promise.resolve(60)
        };
    }
    async getUserProfile(identifier) {
        return {
            tier: 'free',
            reputation: 0.5
        };
    }
    async getIPLocation(ip) {
        return {
            country: 'US',
            region: 'CA'
        };
    }
}
// In-memory rate limit store implementation
class InMemoryRateLimitStore {
    getRequestsInWindow(identifier, windowStart, windowEnd) {
        const requests = this.requests.get(identifier) || [];
        return requests.filter((time)=>time >= windowStart && time <= windowEnd);
    }
    recordRequest(identifier, timestamp) {
        if (!this.requests.has(identifier)) {
            this.requests.set(identifier, []);
        }
        this.requests.get(identifier).push(timestamp);
    }
    getWindowCount(windowKey) {
        const entry = this.windowCounts.get(windowKey);
        if (!entry || Date.now() > entry.expiry) {
            return 0;
        }
        return entry.count;
    }
    incrementWindowCount(windowKey, windowDuration) {
        const entry = this.windowCounts.get(windowKey) || {
            count: 0,
            expiry: 0
        };
        entry.count++;
        entry.expiry = Date.now() + windowDuration;
        this.windowCounts.set(windowKey, entry);
    }
    getTokenBucket(identifier) {
        return this.tokenBuckets.get(identifier) || null;
    }
    setTokenBucket(identifier, bucket) {
        this.tokenBuckets.set(identifier, bucket);
    }
    getStatistics(timeRange) {
        return {
            totalRequests: 0,
            blockedRequests: 0
        };
    }
    cleanup() {
        const now = Date.now();
        const cleanupAge = 3600000; // 1 hour
        // Clean up old requests
        for (const [identifier, requests] of this.requests){
            const filtered = requests.filter((time)=>now - time < cleanupAge);
            if (filtered.length === 0) {
                this.requests.delete(identifier);
            } else {
                this.requests.set(identifier, filtered);
            }
        }
        // Clean up expired window counts
        for (const [windowKey, entry] of this.windowCounts){
            if (now > entry.expiry) {
                this.windowCounts.delete(windowKey);
            }
        }
    }
    constructor(){
        this.requests = new Map();
        this.windowCounts = new Map();
        this.tokenBuckets = new Map();
    }
}
const advancedRateLimiter = new AdvancedRateLimiter();

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcTWljaGFcXEZhdm9yaXRlc1xcRG93bmxvYWRzXFxvbW5pcHJlbmV1clxcbGliXFxyYXRlLWxpbWl0XFxhZHZhbmNlZC1saW1pdGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEB0cy1ub2NoZWNrXHJcbmltcG9ydCB7IEV2ZW50RW1pdHRlciB9IGZyb20gJ2V2ZW50cyc7XHJcblxyXG4vLyBBZHZhbmNlZCByYXRlIGxpbWl0aW5nIHN5c3RlbSB3aXRoIG11bHRpcGxlIHN0cmF0ZWdpZXNcclxuZXhwb3J0IGNsYXNzIEFkdmFuY2VkUmF0ZUxpbWl0ZXIgZXh0ZW5kcyBFdmVudEVtaXR0ZXIge1xyXG4gIHByaXZhdGUgc3RvcmVzOiBNYXA8c3RyaW5nLCBSYXRlTGltaXRTdG9yZT4gPSBuZXcgTWFwKCk7XHJcbiAgcHJpdmF0ZSBydWxlczogTWFwPHN0cmluZywgUmF0ZUxpbWl0UnVsZVtdPiA9IG5ldyBNYXAoKTtcclxuICBwcml2YXRlIGdsb2JhbExpbWl0czogTWFwPHN0cmluZywgR2xvYmFsTGltaXQ+ID0gbmV3IE1hcCgpO1xyXG4gIHByaXZhdGUgd2hpdGVsaXN0ZWRJUHM6IFNldDxzdHJpbmc+ID0gbmV3IFNldCgpO1xyXG4gIHByaXZhdGUgYmxhY2tsaXN0ZWRJUHM6IFNldDxzdHJpbmc+ID0gbmV3IFNldCgpO1xyXG4gIHByaXZhdGUgc3VzcGljaW91c0FjdGl2aXR5OiBNYXA8c3RyaW5nLCBTdXNwaWNpb3VzQWN0aXZpdHk+ID0gbmV3IE1hcCgpO1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHN1cGVyKCk7XHJcbiAgICB0aGlzLmluaXRpYWxpemVEZWZhdWx0UnVsZXMoKTtcclxuICAgIHRoaXMuc3RhcnRDbGVhbnVwVGltZXIoKTtcclxuICB9XHJcblxyXG4gIC8vIE1haW4gcmF0ZSBsaW1pdGluZyBmdW5jdGlvblxyXG4gIGFzeW5jIGNoZWNrTGltaXQocmVxdWVzdDogUmF0ZUxpbWl0UmVxdWVzdCk6IFByb21pc2U8UmF0ZUxpbWl0UmVzdWx0PiB7XHJcbiAgICBjb25zdCBpZGVudGlmaWVyID0gdGhpcy5nZXRJZGVudGlmaWVyKHJlcXVlc3QpO1xyXG4gICAgXHJcbiAgICAvLyBDaGVjayBibGFja2xpc3QgZmlyc3RcclxuICAgIGlmICh0aGlzLmJsYWNrbGlzdGVkSVBzLmhhcyhyZXF1ZXN0LmlwKSkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGFsbG93ZWQ6IGZhbHNlLFxyXG4gICAgICAgIHJlYXNvbjogJ0lQX0JMQUNLTElTVEVEJyxcclxuICAgICAgICByZXNldFRpbWU6IERhdGUubm93KCkgKyAzNjAwMDAwLCAvLyAxIGhvdXJcclxuICAgICAgICByZXRyeUFmdGVyOiAzNjAwXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIENoZWNrIHdoaXRlbGlzdCAtIGJ5cGFzcyByYXRlIGxpbWl0c1xyXG4gICAgaWYgKHRoaXMud2hpdGVsaXN0ZWRJUHMuaGFzKHJlcXVlc3QuaXApKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgYWxsb3dlZDogdHJ1ZSxcclxuICAgICAgICByZWFzb246ICdXSElURUxJU1RFRCcsXHJcbiAgICAgICAgcmVtYWluaW5nOiBJbmZpbml0eSxcclxuICAgICAgICByZXNldFRpbWU6IERhdGUubm93KCkgKyAzNjAwMDAwXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEdldCBhcHBsaWNhYmxlIHJ1bGVzXHJcbiAgICBjb25zdCBydWxlcyA9IHRoaXMuZ2V0UnVsZXNGb3JSZXF1ZXN0KHJlcXVlc3QpO1xyXG4gICAgXHJcbiAgICAvLyBDaGVjayBlYWNoIHJ1bGVcclxuICAgIGZvciAoY29uc3QgcnVsZSBvZiBydWxlcykge1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmNoZWNrUnVsZShydWxlLCBpZGVudGlmaWVyLCByZXF1ZXN0KTtcclxuICAgICAgXHJcbiAgICAgIGlmICghcmVzdWx0LmFsbG93ZWQpIHtcclxuICAgICAgICAvLyBUcmFjayBmYWlsZWQgYXR0ZW1wdHMgZm9yIHN1c3BpY2lvdXMgYWN0aXZpdHkgZGV0ZWN0aW9uXHJcbiAgICAgICAgdGhpcy50cmFja1N1c3BpY2lvdXNBY3Rpdml0eShyZXF1ZXN0LmlwLCBydWxlKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBFbWl0IHJhdGUgbGltaXQgZXZlbnRcclxuICAgICAgICB0aGlzLmVtaXQoJ3JhdGVMaW1pdDpleGNlZWRlZCcsIHtcclxuICAgICAgICAgIHJ1bGU6IHJ1bGUubmFtZSxcclxuICAgICAgICAgIGlkZW50aWZpZXIsXHJcbiAgICAgICAgICByZXF1ZXN0LFxyXG4gICAgICAgICAgcmVzdWx0XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBDaGVjayBnbG9iYWwgbGltaXRzXHJcbiAgICBjb25zdCBnbG9iYWxSZXN1bHQgPSBhd2FpdCB0aGlzLmNoZWNrR2xvYmFsTGltaXRzKHJlcXVlc3QpO1xyXG4gICAgaWYgKCFnbG9iYWxSZXN1bHQuYWxsb3dlZCkge1xyXG4gICAgICByZXR1cm4gZ2xvYmFsUmVzdWx0O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBBbGwgY2hlY2tzIHBhc3NlZCAtIHJlY29yZCB0aGUgcmVxdWVzdFxyXG4gICAgYXdhaXQgdGhpcy5yZWNvcmRSZXF1ZXN0KGlkZW50aWZpZXIsIHJlcXVlc3QpO1xyXG4gICAgXHJcbiAgICAvLyBHZXQgcmVtYWluaW5nIGNvdW50IGZvciB0aGUgbW9zdCByZXN0cmljdGl2ZSBydWxlXHJcbiAgICBjb25zdCByZW1haW5pbmcgPSBhd2FpdCB0aGlzLmdldFJlbWFpbmluZ0NvdW50KHJ1bGVzLCBpZGVudGlmaWVyKTtcclxuICAgIFxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgYWxsb3dlZDogdHJ1ZSxcclxuICAgICAgcmVtYWluaW5nLFxyXG4gICAgICByZXNldFRpbWU6IERhdGUubm93KCkgKyBNYXRoLm1pbiguLi5ydWxlcy5tYXAociA9PiByLndpbmRvdykpXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLy8gQWRkIGN1c3RvbSByYXRlIGxpbWl0IHJ1bGVcclxuICBhZGRSdWxlKHJ1bGU6IFJhdGVMaW1pdFJ1bGUpOiB2b2lkIHtcclxuICAgIGNvbnN0IGVuZHBvaW50ID0gcnVsZS5lbmRwb2ludCB8fCAnKic7XHJcbiAgICBcclxuICAgIGlmICghdGhpcy5ydWxlcy5oYXMoZW5kcG9pbnQpKSB7XHJcbiAgICAgIHRoaXMucnVsZXMuc2V0KGVuZHBvaW50LCBbXSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHRoaXMucnVsZXMuZ2V0KGVuZHBvaW50KSEucHVzaChydWxlKTtcclxuICAgIFxyXG4gICAgLy8gU29ydCBydWxlcyBieSBwcmlvcml0eSAoaGlnaGVyIGZpcnN0KVxyXG4gICAgdGhpcy5ydWxlcy5nZXQoZW5kcG9pbnQpIS5zb3J0KChhLCBiKSA9PiAoYi5wcmlvcml0eSB8fCAwKSAtIChhLnByaW9yaXR5IHx8IDApKTtcclxuICB9XHJcblxyXG4gIC8vIER5bmFtaWMgcmF0ZSBsaW1pdGluZyBiYXNlZCBvbiBzeXN0ZW0gbG9hZFxyXG4gIGFzeW5jIGFkanVzdExpbWl0c0Jhc2VkT25Mb2FkKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgY29uc3Qgc3lzdGVtTG9hZCA9IGF3YWl0IHRoaXMuZ2V0U3lzdGVtTG9hZCgpO1xyXG4gICAgY29uc3QgZGJMb2FkID0gYXdhaXQgdGhpcy5nZXREYXRhYmFzZUxvYWQoKTtcclxuICAgIFxyXG4gICAgLy8gUmVkdWNlIGxpbWl0cyBpZiBzeXN0ZW0gaXMgdW5kZXIgaGlnaCBsb2FkXHJcbiAgICBpZiAoc3lzdGVtTG9hZCA+IDgwIHx8IGRiTG9hZCA+IDgwKSB7XHJcbiAgICAgIHRoaXMuYXBwbHlMb2FkQmFzZWRMaW1pdHMoMC41KTsgLy8gUmVkdWNlIGJ5IDUwJVxyXG4gICAgICB0aGlzLmVtaXQoJ3JhdGVMaW1pdDpsb2FkQWRqdXN0bWVudCcsIHsgc3lzdGVtTG9hZCwgZGJMb2FkLCBmYWN0b3I6IDAuNSB9KTtcclxuICAgIH0gZWxzZSBpZiAoc3lzdGVtTG9hZCA+IDYwIHx8IGRiTG9hZCA+IDYwKSB7XHJcbiAgICAgIHRoaXMuYXBwbHlMb2FkQmFzZWRMaW1pdHMoMC43NSk7IC8vIFJlZHVjZSBieSAyNSVcclxuICAgICAgdGhpcy5lbWl0KCdyYXRlTGltaXQ6bG9hZEFkanVzdG1lbnQnLCB7IHN5c3RlbUxvYWQsIGRiTG9hZCwgZmFjdG9yOiAwLjc1IH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5hcHBseUxvYWRCYXNlZExpbWl0cygxLjApOyAvLyBOb3JtYWwgbGltaXRzXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBTbGlkaW5nIHdpbmRvdyByYXRlIGxpbWl0aW5nXHJcbiAgYXN5bmMgc2xpZGluZ1dpbmRvd0NoZWNrKHJ1bGU6IFJhdGVMaW1pdFJ1bGUsIGlkZW50aWZpZXI6IHN0cmluZyk6IFByb21pc2U8UmF0ZUxpbWl0UmVzdWx0PiB7XHJcbiAgICBjb25zdCBzdG9yZSA9IHRoaXMuZ2V0U3RvcmUocnVsZS5uYW1lKTtcclxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcbiAgICBjb25zdCB3aW5kb3dTdGFydCA9IG5vdyAtIHJ1bGUud2luZG93O1xyXG4gICAgXHJcbiAgICAvLyBHZXQgcmVxdWVzdHMgaW4gdGhlIGN1cnJlbnQgd2luZG93XHJcbiAgICBjb25zdCByZXF1ZXN0cyA9IHN0b3JlLmdldFJlcXVlc3RzSW5XaW5kb3coaWRlbnRpZmllciwgd2luZG93U3RhcnQsIG5vdyk7XHJcbiAgICBcclxuICAgIGlmIChyZXF1ZXN0cy5sZW5ndGggPj0gcnVsZS5saW1pdCkge1xyXG4gICAgICBjb25zdCBvbGRlc3RSZXF1ZXN0ID0gTWF0aC5taW4oLi4ucmVxdWVzdHMpO1xyXG4gICAgICBjb25zdCByZXNldFRpbWUgPSBvbGRlc3RSZXF1ZXN0ICsgcnVsZS53aW5kb3c7XHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGFsbG93ZWQ6IGZhbHNlLFxyXG4gICAgICAgIHJlYXNvbjogJ1JBVEVfTElNSVRfRVhDRUVERUQnLFxyXG4gICAgICAgIHJlc2V0VGltZSxcclxuICAgICAgICByZXRyeUFmdGVyOiBNYXRoLmNlaWwoKHJlc2V0VGltZSAtIG5vdykgLyAxMDAwKSxcclxuICAgICAgICBsaW1pdDogcnVsZS5saW1pdCxcclxuICAgICAgICByZW1haW5pbmc6IDBcclxuICAgICAgfTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgYWxsb3dlZDogdHJ1ZSxcclxuICAgICAgcmVtYWluaW5nOiBydWxlLmxpbWl0IC0gcmVxdWVzdHMubGVuZ3RoIC0gMSxcclxuICAgICAgcmVzZXRUaW1lOiBub3cgKyBydWxlLndpbmRvd1xyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8vIFRva2VuIGJ1Y2tldCByYXRlIGxpbWl0aW5nXHJcbiAgYXN5bmMgdG9rZW5CdWNrZXRDaGVjayhydWxlOiBSYXRlTGltaXRSdWxlLCBpZGVudGlmaWVyOiBzdHJpbmcpOiBQcm9taXNlPFJhdGVMaW1pdFJlc3VsdD4ge1xyXG4gICAgY29uc3Qgc3RvcmUgPSB0aGlzLmdldFN0b3JlKHJ1bGUubmFtZSk7XHJcbiAgICBjb25zdCBidWNrZXQgPSBzdG9yZS5nZXRUb2tlbkJ1Y2tldChpZGVudGlmaWVyKSB8fCB7XHJcbiAgICAgIHRva2VuczogcnVsZS5saW1pdCxcclxuICAgICAgbGFzdFJlZmlsbDogRGF0ZS5ub3coKVxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcclxuICAgIGNvbnN0IHRpbWVQYXNzZWQgPSBub3cgLSBidWNrZXQubGFzdFJlZmlsbDtcclxuICAgIGNvbnN0IHRva2Vuc1RvQWRkID0gTWF0aC5mbG9vcih0aW1lUGFzc2VkIC8gKHJ1bGUud2luZG93IC8gcnVsZS5saW1pdCkpO1xyXG4gICAgXHJcbiAgICAvLyBSZWZpbGwgdG9rZW5zXHJcbiAgICBidWNrZXQudG9rZW5zID0gTWF0aC5taW4ocnVsZS5saW1pdCwgYnVja2V0LnRva2VucyArIHRva2Vuc1RvQWRkKTtcclxuICAgIGJ1Y2tldC5sYXN0UmVmaWxsID0gbm93O1xyXG4gICAgXHJcbiAgICBpZiAoYnVja2V0LnRva2VucyA8IDEpIHtcclxuICAgICAgY29uc3QgcmVmaWxsVGltZSA9IGJ1Y2tldC5sYXN0UmVmaWxsICsgKHJ1bGUud2luZG93IC8gcnVsZS5saW1pdCk7XHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGFsbG93ZWQ6IGZhbHNlLFxyXG4gICAgICAgIHJlYXNvbjogJ1JBVEVfTElNSVRfRVhDRUVERUQnLFxyXG4gICAgICAgIHJlc2V0VGltZTogcmVmaWxsVGltZSxcclxuICAgICAgICByZXRyeUFmdGVyOiBNYXRoLmNlaWwoKHJlZmlsbFRpbWUgLSBub3cpIC8gMTAwMCksXHJcbiAgICAgICAgcmVtYWluaW5nOiAwXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIENvbnN1bWUgdG9rZW5cclxuICAgIGJ1Y2tldC50b2tlbnMgLT0gMTtcclxuICAgIHN0b3JlLnNldFRva2VuQnVja2V0KGlkZW50aWZpZXIsIGJ1Y2tldCk7XHJcbiAgICBcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGFsbG93ZWQ6IHRydWUsXHJcbiAgICAgIHJlbWFpbmluZzogTWF0aC5mbG9vcihidWNrZXQudG9rZW5zKSxcclxuICAgICAgcmVzZXRUaW1lOiBub3cgKyBydWxlLndpbmRvd1xyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8vIEZpeGVkIHdpbmRvdyByYXRlIGxpbWl0aW5nXHJcbiAgYXN5bmMgZml4ZWRXaW5kb3dDaGVjayhydWxlOiBSYXRlTGltaXRSdWxlLCBpZGVudGlmaWVyOiBzdHJpbmcpOiBQcm9taXNlPFJhdGVMaW1pdFJlc3VsdD4ge1xyXG4gICAgY29uc3Qgc3RvcmUgPSB0aGlzLmdldFN0b3JlKHJ1bGUubmFtZSk7XHJcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG4gICAgY29uc3Qgd2luZG93U3RhcnQgPSBNYXRoLmZsb29yKG5vdyAvIHJ1bGUud2luZG93KSAqIHJ1bGUud2luZG93O1xyXG4gICAgY29uc3Qgd2luZG93S2V5ID0gYCR7aWRlbnRpZmllcn06JHt3aW5kb3dTdGFydH1gO1xyXG4gICAgXHJcbiAgICBjb25zdCBjb3VudCA9IHN0b3JlLmdldFdpbmRvd0NvdW50KHdpbmRvd0tleSkgfHwgMDtcclxuICAgIFxyXG4gICAgaWYgKGNvdW50ID49IHJ1bGUubGltaXQpIHtcclxuICAgICAgY29uc3QgcmVzZXRUaW1lID0gd2luZG93U3RhcnQgKyBydWxlLndpbmRvdztcclxuICAgICAgXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgYWxsb3dlZDogZmFsc2UsXHJcbiAgICAgICAgcmVhc29uOiAnUkFURV9MSU1JVF9FWENFRURFRCcsXHJcbiAgICAgICAgcmVzZXRUaW1lLFxyXG4gICAgICAgIHJldHJ5QWZ0ZXI6IE1hdGguY2VpbCgocmVzZXRUaW1lIC0gbm93KSAvIDEwMDApLFxyXG4gICAgICAgIHJlbWFpbmluZzogMFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBJbmNyZW1lbnQgY291bnRlclxyXG4gICAgc3RvcmUuaW5jcmVtZW50V2luZG93Q291bnQod2luZG93S2V5LCBydWxlLndpbmRvdyk7XHJcbiAgICBcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGFsbG93ZWQ6IHRydWUsXHJcbiAgICAgIHJlbWFpbmluZzogcnVsZS5saW1pdCAtIGNvdW50IC0gMSxcclxuICAgICAgcmVzZXRUaW1lOiB3aW5kb3dTdGFydCArIHJ1bGUud2luZG93XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLy8gRGlzdHJpYnV0ZWQgcmF0ZSBsaW1pdGluZyBmb3IgbXVsdGktc2VydmVyIHNldHVwc1xyXG4gIGFzeW5jIGRpc3RyaWJ1dGVkQ2hlY2socnVsZTogUmF0ZUxpbWl0UnVsZSwgaWRlbnRpZmllcjogc3RyaW5nKTogUHJvbWlzZTxSYXRlTGltaXRSZXN1bHQ+IHtcclxuICAgIGlmICghcnVsZS5kaXN0cmlidXRlZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1J1bGUgaXMgbm90IGNvbmZpZ3VyZWQgZm9yIGRpc3RyaWJ1dGVkIHJhdGUgbGltaXRpbmcnKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gVXNlIFJlZGlzIG9yIHNpbWlsYXIgZm9yIGRpc3RyaWJ1dGVkIHN0YXRlXHJcbiAgICBjb25zdCBkaXN0cmlidXRlZFN0b3JlID0gYXdhaXQgdGhpcy5nZXREaXN0cmlidXRlZFN0b3JlKCk7XHJcbiAgICBjb25zdCBrZXkgPSBgcmF0ZV9saW1pdDoke3J1bGUubmFtZX06JHtpZGVudGlmaWVyfWA7XHJcbiAgICBcclxuICAgIGNvbnN0IHBpcGVsaW5lID0gZGlzdHJpYnV0ZWRTdG9yZS5waXBlbGluZSgpO1xyXG4gICAgcGlwZWxpbmUuaW5jcihrZXkpO1xyXG4gICAgcGlwZWxpbmUuZXhwaXJlKGtleSwgTWF0aC5jZWlsKHJ1bGUud2luZG93IC8gMTAwMCkpO1xyXG4gICAgXHJcbiAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgcGlwZWxpbmUuZXhlYygpO1xyXG4gICAgY29uc3QgY291bnQgPSByZXN1bHRzWzBdWzFdIGFzIG51bWJlcjtcclxuICAgIFxyXG4gICAgaWYgKGNvdW50ID4gcnVsZS5saW1pdCkge1xyXG4gICAgICBjb25zdCB0dGwgPSBhd2FpdCBkaXN0cmlidXRlZFN0b3JlLnR0bChrZXkpO1xyXG4gICAgICBjb25zdCByZXNldFRpbWUgPSBEYXRlLm5vdygpICsgKHR0bCAqIDEwMDApO1xyXG4gICAgICBcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBhbGxvd2VkOiBmYWxzZSxcclxuICAgICAgICByZWFzb246ICdSQVRFX0xJTUlUX0VYQ0VFREVEJyxcclxuICAgICAgICByZXNldFRpbWUsXHJcbiAgICAgICAgcmV0cnlBZnRlcjogdHRsLFxyXG4gICAgICAgIHJlbWFpbmluZzogMFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBhbGxvd2VkOiB0cnVlLFxyXG4gICAgICByZW1haW5pbmc6IHJ1bGUubGltaXQgLSBjb3VudCxcclxuICAgICAgcmVzZXRUaW1lOiBEYXRlLm5vdygpICsgcnVsZS53aW5kb3dcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvLyBBZGFwdGl2ZSByYXRlIGxpbWl0aW5nIGJhc2VkIG9uIHVzZXIgYmVoYXZpb3JcclxuICBhc3luYyBhZGFwdGl2ZUNoZWNrKHJ1bGU6IFJhdGVMaW1pdFJ1bGUsIGlkZW50aWZpZXI6IHN0cmluZywgcmVxdWVzdDogUmF0ZUxpbWl0UmVxdWVzdCk6IFByb21pc2U8UmF0ZUxpbWl0UmVzdWx0PiB7XHJcbiAgICBjb25zdCB1c2VyUHJvZmlsZSA9IGF3YWl0IHRoaXMuZ2V0VXNlclByb2ZpbGUoaWRlbnRpZmllcik7XHJcbiAgICBcclxuICAgIC8vIEFkanVzdCBsaW1pdHMgYmFzZWQgb24gdXNlciB0aWVyXHJcbiAgICBsZXQgYWRqdXN0ZWRMaW1pdCA9IHJ1bGUubGltaXQ7XHJcbiAgICBcclxuICAgIHN3aXRjaCAodXNlclByb2ZpbGUudGllcikge1xyXG4gICAgICBjYXNlICdwcmVtaXVtJzpcclxuICAgICAgICBhZGp1c3RlZExpbWl0ICo9IDI7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ2VudGVycHJpc2UnOlxyXG4gICAgICAgIGFkanVzdGVkTGltaXQgKj0gNTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnZnJlZSc6XHJcbiAgICAgICAgYWRqdXN0ZWRMaW1pdCAqPSAwLjU7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEFkanVzdCBiYXNlZCBvbiB1c2VyIHJlcHV0YXRpb25cclxuICAgIGlmICh1c2VyUHJvZmlsZS5yZXB1dGF0aW9uID4gMC44KSB7XHJcbiAgICAgIGFkanVzdGVkTGltaXQgKj0gMS41O1xyXG4gICAgfSBlbHNlIGlmICh1c2VyUHJvZmlsZS5yZXB1dGF0aW9uIDwgMC4zKSB7XHJcbiAgICAgIGFkanVzdGVkTGltaXQgKj0gMC41O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBDcmVhdGUgYWRqdXN0ZWQgcnVsZVxyXG4gICAgY29uc3QgYWRqdXN0ZWRSdWxlID0geyAuLi5ydWxlLCBsaW1pdDogTWF0aC5mbG9vcihhZGp1c3RlZExpbWl0KSB9O1xyXG4gICAgXHJcbiAgICByZXR1cm4gdGhpcy5zbGlkaW5nV2luZG93Q2hlY2soYWRqdXN0ZWRSdWxlLCBpZGVudGlmaWVyKTtcclxuICB9XHJcblxyXG4gIC8vIElQLWJhc2VkIGdlb2dyYXBoaWMgcmF0ZSBsaW1pdGluZ1xyXG4gIGFzeW5jIGdlb2dyYXBoaWNDaGVjayhydWxlOiBSYXRlTGltaXRSdWxlLCByZXF1ZXN0OiBSYXRlTGltaXRSZXF1ZXN0KTogUHJvbWlzZTxSYXRlTGltaXRSZXN1bHQ+IHtcclxuICAgIGlmICghcnVsZS5nZW9ncmFwaGljKSByZXR1cm4geyBhbGxvd2VkOiB0cnVlIH07XHJcbiAgICBcclxuICAgIGNvbnN0IGxvY2F0aW9uID0gYXdhaXQgdGhpcy5nZXRJUExvY2F0aW9uKHJlcXVlc3QuaXApO1xyXG4gICAgY29uc3QgZ2VvUnVsZSA9IHJ1bGUuZ2VvZ3JhcGhpY1tsb2NhdGlvbi5jb3VudHJ5XSB8fCBydWxlLmdlb2dyYXBoaWMuZGVmYXVsdDtcclxuICAgIFxyXG4gICAgaWYgKCFnZW9SdWxlKSByZXR1cm4geyBhbGxvd2VkOiB0cnVlIH07XHJcbiAgICBcclxuICAgIGNvbnN0IGFkanVzdGVkUnVsZSA9IHsgLi4ucnVsZSwgLi4uZ2VvUnVsZSB9O1xyXG4gICAgcmV0dXJuIHRoaXMuc2xpZGluZ1dpbmRvd0NoZWNrKGFkanVzdGVkUnVsZSwgcmVxdWVzdC5pcCk7XHJcbiAgfVxyXG5cclxuICAvLyBCdXJzdCBwcm90ZWN0aW9uXHJcbiAgYXN5bmMgYnVyc3RQcm90ZWN0aW9uQ2hlY2socnVsZTogUmF0ZUxpbWl0UnVsZSwgaWRlbnRpZmllcjogc3RyaW5nKTogUHJvbWlzZTxSYXRlTGltaXRSZXN1bHQ+IHtcclxuICAgIGlmICghcnVsZS5idXJzdFByb3RlY3Rpb24pIHJldHVybiB7IGFsbG93ZWQ6IHRydWUgfTtcclxuICAgIFxyXG4gICAgY29uc3Qgc3RvcmUgPSB0aGlzLmdldFN0b3JlKHJ1bGUubmFtZSk7XHJcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG4gICAgY29uc3QgYnVyc3RXaW5kb3cgPSBydWxlLmJ1cnN0UHJvdGVjdGlvbi53aW5kb3cgfHwgMTAwMDsgLy8gMSBzZWNvbmQgZGVmYXVsdFxyXG4gICAgY29uc3QgYnVyc3RMaW1pdCA9IHJ1bGUuYnVyc3RQcm90ZWN0aW9uLmxpbWl0IHx8IDU7XHJcbiAgICBcclxuICAgIGNvbnN0IHJlY2VudFJlcXVlc3RzID0gc3RvcmUuZ2V0UmVxdWVzdHNJbldpbmRvdyhcclxuICAgICAgaWRlbnRpZmllciwgXHJcbiAgICAgIG5vdyAtIGJ1cnN0V2luZG93LCBcclxuICAgICAgbm93XHJcbiAgICApO1xyXG4gICAgXHJcbiAgICBpZiAocmVjZW50UmVxdWVzdHMubGVuZ3RoID49IGJ1cnN0TGltaXQpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBhbGxvd2VkOiBmYWxzZSxcclxuICAgICAgICByZWFzb246ICdCVVJTVF9MSU1JVF9FWENFRURFRCcsXHJcbiAgICAgICAgcmVzZXRUaW1lOiBub3cgKyBidXJzdFdpbmRvdyxcclxuICAgICAgICByZXRyeUFmdGVyOiBNYXRoLmNlaWwoYnVyc3RXaW5kb3cgLyAxMDAwKVxyXG4gICAgICB9O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4geyBhbGxvd2VkOiB0cnVlIH07XHJcbiAgfVxyXG5cclxuICAvLyBXaGl0ZWxpc3QvQmxhY2tsaXN0IG1hbmFnZW1lbnRcclxuICBhZGRUb1doaXRlbGlzdChpcDogc3RyaW5nKTogdm9pZCB7XHJcbiAgICB0aGlzLndoaXRlbGlzdGVkSVBzLmFkZChpcCk7XHJcbiAgICB0aGlzLmVtaXQoJ3doaXRlbGlzdDphZGRlZCcsIHsgaXAgfSk7XHJcbiAgfVxyXG5cclxuICByZW1vdmVGcm9tV2hpdGVsaXN0KGlwOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIHRoaXMud2hpdGVsaXN0ZWRJUHMuZGVsZXRlKGlwKTtcclxuICAgIHRoaXMuZW1pdCgnd2hpdGVsaXN0OnJlbW92ZWQnLCB7IGlwIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkVG9CbGFja2xpc3QoaXA6IHN0cmluZywgZHVyYXRpb24/OiBudW1iZXIpOiB2b2lkIHtcclxuICAgIHRoaXMuYmxhY2tsaXN0ZWRJUHMuYWRkKGlwKTtcclxuICAgIHRoaXMuZW1pdCgnYmxhY2tsaXN0OmFkZGVkJywgeyBpcCwgZHVyYXRpb24gfSk7XHJcbiAgICBcclxuICAgIGlmIChkdXJhdGlvbikge1xyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICB0aGlzLnJlbW92ZUZyb21CbGFja2xpc3QoaXApO1xyXG4gICAgICB9LCBkdXJhdGlvbik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZW1vdmVGcm9tQmxhY2tsaXN0KGlwOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIHRoaXMuYmxhY2tsaXN0ZWRJUHMuZGVsZXRlKGlwKTtcclxuICAgIHRoaXMuZW1pdCgnYmxhY2tsaXN0OnJlbW92ZWQnLCB7IGlwIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gU3VzcGljaW91cyBhY3Rpdml0eSBkZXRlY3Rpb25cclxuICBwcml2YXRlIHRyYWNrU3VzcGljaW91c0FjdGl2aXR5KGlwOiBzdHJpbmcsIHJ1bGU6IFJhdGVMaW1pdFJ1bGUpOiB2b2lkIHtcclxuICAgIGNvbnN0IGFjdGl2aXR5ID0gdGhpcy5zdXNwaWNpb3VzQWN0aXZpdHkuZ2V0KGlwKSB8fCB7XHJcbiAgICAgIHZpb2xhdGlvbnM6IDAsXHJcbiAgICAgIGZpcnN0VmlvbGF0aW9uOiBEYXRlLm5vdygpLFxyXG4gICAgICBsYXN0VmlvbGF0aW9uOiBEYXRlLm5vdygpLFxyXG4gICAgICBydWxlczogbmV3IFNldCgpXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBhY3Rpdml0eS52aW9sYXRpb25zKys7XHJcbiAgICBhY3Rpdml0eS5sYXN0VmlvbGF0aW9uID0gRGF0ZS5ub3coKTtcclxuICAgIGFjdGl2aXR5LnJ1bGVzLmFkZChydWxlLm5hbWUpO1xyXG4gICAgXHJcbiAgICB0aGlzLnN1c3BpY2lvdXNBY3Rpdml0eS5zZXQoaXAsIGFjdGl2aXR5KTtcclxuICAgIFxyXG4gICAgLy8gQXV0by1ibGFja2xpc3QgYWZ0ZXIgdGhyZXNob2xkXHJcbiAgICBpZiAoYWN0aXZpdHkudmlvbGF0aW9ucyA+PSAxMCkge1xyXG4gICAgICB0aGlzLmFkZFRvQmxhY2tsaXN0KGlwLCAzNjAwMDAwKTsgLy8gMSBob3VyXHJcbiAgICAgIHRoaXMuZW1pdCgnc2VjdXJpdHk6YXV0b0JsYWNrbGlzdCcsIHsgaXAsIGFjdGl2aXR5IH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gR2V0IHJhdGUgbGltaXQgc3RhdGlzdGljc1xyXG4gIGFzeW5jIGdldFN0YXRpc3RpY3ModGltZVJhbmdlOiBzdHJpbmcgPSAnMWgnKTogUHJvbWlzZTxSYXRlTGltaXRTdGF0aXN0aWNzPiB7XHJcbiAgICBjb25zdCBzdGF0czogUmF0ZUxpbWl0U3RhdGlzdGljcyA9IHtcclxuICAgICAgdG90YWxSZXF1ZXN0czogMCxcclxuICAgICAgYmxvY2tlZFJlcXVlc3RzOiAwLFxyXG4gICAgICB0b3BCbG9ja2VkSVBzOiBbXSxcclxuICAgICAgdG9wQmxvY2tlZEVuZHBvaW50czogW10sXHJcbiAgICAgIHJ1bGVzOiBbXVxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLy8gQWdncmVnYXRlIHN0YXRpc3RpY3MgZnJvbSBhbGwgc3RvcmVzXHJcbiAgICBmb3IgKGNvbnN0IFtydWxlTmFtZSwgc3RvcmVdIG9mIHRoaXMuc3RvcmVzKSB7XHJcbiAgICAgIGNvbnN0IHJ1bGVTdGF0cyA9IHN0b3JlLmdldFN0YXRpc3RpY3ModGltZVJhbmdlKTtcclxuICAgICAgc3RhdHMudG90YWxSZXF1ZXN0cyArPSBydWxlU3RhdHMudG90YWxSZXF1ZXN0cztcclxuICAgICAgc3RhdHMuYmxvY2tlZFJlcXVlc3RzICs9IHJ1bGVTdGF0cy5ibG9ja2VkUmVxdWVzdHM7XHJcbiAgICAgIFxyXG4gICAgICBzdGF0cy5ydWxlcy5wdXNoKHtcclxuICAgICAgICBuYW1lOiBydWxlTmFtZSxcclxuICAgICAgICAuLi5ydWxlU3RhdHNcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBzdGF0cztcclxuICB9XHJcblxyXG4gIC8vIFByaXZhdGUgaGVscGVyIG1ldGhvZHNcclxuICBwcml2YXRlIGluaXRpYWxpemVEZWZhdWx0UnVsZXMoKTogdm9pZCB7XHJcbiAgICAvLyBHbG9iYWwgQVBJIHJhdGUgbGltaXRcclxuICAgIHRoaXMuYWRkUnVsZSh7XHJcbiAgICAgIG5hbWU6ICdnbG9iYWxfYXBpJyxcclxuICAgICAgZW5kcG9pbnQ6ICcvYXBpLyonLFxyXG4gICAgICBsaW1pdDogMTAwMCxcclxuICAgICAgd2luZG93OiAzNjAwMDAwLCAvLyAxIGhvdXJcclxuICAgICAgYWxnb3JpdGhtOiAnc2xpZGluZ193aW5kb3cnLFxyXG4gICAgICBwcmlvcml0eTogMVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8vIEF1dGhlbnRpY2F0aW9uIGVuZHBvaW50c1xyXG4gICAgdGhpcy5hZGRSdWxlKHtcclxuICAgICAgbmFtZTogJ2F1dGhfc3RyaWN0JyxcclxuICAgICAgZW5kcG9pbnQ6ICcvYXBpL2F1dGgvKicsXHJcbiAgICAgIGxpbWl0OiA1LFxyXG4gICAgICB3aW5kb3c6IDkwMDAwMCwgLy8gMTUgbWludXRlc1xyXG4gICAgICBhbGdvcml0aG06ICdmaXhlZF93aW5kb3cnLFxyXG4gICAgICBwcmlvcml0eTogMTAsXHJcbiAgICAgIGJ1cnN0UHJvdGVjdGlvbjoge1xyXG4gICAgICAgIGxpbWl0OiAzLFxyXG4gICAgICAgIHdpbmRvdzogNjAwMDAgLy8gMSBtaW51dGVcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8vIFVwbG9hZCBlbmRwb2ludHNcclxuICAgIHRoaXMuYWRkUnVsZSh7XHJcbiAgICAgIG5hbWU6ICd1cGxvYWRfbGltaXQnLFxyXG4gICAgICBlbmRwb2ludDogJy9hcGkvdXBsb2FkJyxcclxuICAgICAgbGltaXQ6IDUwLFxyXG4gICAgICB3aW5kb3c6IDM2MDAwMDAsIC8vIDEgaG91clxyXG4gICAgICBhbGdvcml0aG06ICd0b2tlbl9idWNrZXQnLFxyXG4gICAgICBwcmlvcml0eTogNVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8vIEVtYWlsIGNhbXBhaWduIGVuZHBvaW50c1xyXG4gICAgdGhpcy5hZGRSdWxlKHtcclxuICAgICAgbmFtZTogJ2VtYWlsX2NhbXBhaWducycsXHJcbiAgICAgIGVuZHBvaW50OiAnL2FwaS9lbWFpbC1jYW1wYWlnbnMvKicsXHJcbiAgICAgIGxpbWl0OiAxMDAsXHJcbiAgICAgIHdpbmRvdzogMzYwMDAwMCwgLy8gMSBob3VyXHJcbiAgICAgIGFsZ29yaXRobTogJ3NsaWRpbmdfd2luZG93JyxcclxuICAgICAgcHJpb3JpdHk6IDNcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRJZGVudGlmaWVyKHJlcXVlc3Q6IFJhdGVMaW1pdFJlcXVlc3QpOiBzdHJpbmcge1xyXG4gICAgLy8gVXNlIHVzZXIgSUQgaWYgYXV0aGVudGljYXRlZCwgb3RoZXJ3aXNlIElQXHJcbiAgICByZXR1cm4gcmVxdWVzdC51c2VySWQgfHwgcmVxdWVzdC5pcDtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0UnVsZXNGb3JSZXF1ZXN0KHJlcXVlc3Q6IFJhdGVMaW1pdFJlcXVlc3QpOiBSYXRlTGltaXRSdWxlW10ge1xyXG4gICAgY29uc3QgbWF0Y2hpbmdSdWxlczogUmF0ZUxpbWl0UnVsZVtdID0gW107XHJcbiAgICBcclxuICAgIGZvciAoY29uc3QgW2VuZHBvaW50LCBydWxlc10gb2YgdGhpcy5ydWxlcykge1xyXG4gICAgICBpZiAodGhpcy5lbmRwb2ludE1hdGNoZXMoZW5kcG9pbnQsIHJlcXVlc3QuZW5kcG9pbnQpKSB7XHJcbiAgICAgICAgbWF0Y2hpbmdSdWxlcy5wdXNoKC4uLnJ1bGVzKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gbWF0Y2hpbmdSdWxlcy5zb3J0KChhLCBiKSA9PiAoYi5wcmlvcml0eSB8fCAwKSAtIChhLnByaW9yaXR5IHx8IDApKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZW5kcG9pbnRNYXRjaGVzKHBhdHRlcm46IHN0cmluZywgZW5kcG9pbnQ6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gICAgaWYgKHBhdHRlcm4gPT09ICcqJykgcmV0dXJuIHRydWU7XHJcbiAgICBpZiAocGF0dGVybiA9PT0gZW5kcG9pbnQpIHJldHVybiB0cnVlO1xyXG4gICAgXHJcbiAgICAvLyBTaW1wbGUgd2lsZGNhcmQgbWF0Y2hpbmdcclxuICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cCgnXicgKyBwYXR0ZXJuLnJlcGxhY2UoL1xcKi9nLCAnLionKSArICckJyk7XHJcbiAgICByZXR1cm4gcmVnZXgudGVzdChlbmRwb2ludCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGNoZWNrUnVsZShydWxlOiBSYXRlTGltaXRSdWxlLCBpZGVudGlmaWVyOiBzdHJpbmcsIHJlcXVlc3Q6IFJhdGVMaW1pdFJlcXVlc3QpOiBQcm9taXNlPFJhdGVMaW1pdFJlc3VsdD4ge1xyXG4gICAgLy8gQ2hlY2sgYnVyc3QgcHJvdGVjdGlvbiBmaXJzdFxyXG4gICAgY29uc3QgYnVyc3RSZXN1bHQgPSBhd2FpdCB0aGlzLmJ1cnN0UHJvdGVjdGlvbkNoZWNrKHJ1bGUsIGlkZW50aWZpZXIpO1xyXG4gICAgaWYgKCFidXJzdFJlc3VsdC5hbGxvd2VkKSByZXR1cm4gYnVyc3RSZXN1bHQ7XHJcbiAgICBcclxuICAgIC8vIENoZWNrIGdlb2dyYXBoaWMgcmVzdHJpY3Rpb25zXHJcbiAgICBjb25zdCBnZW9SZXN1bHQgPSBhd2FpdCB0aGlzLmdlb2dyYXBoaWNDaGVjayhydWxlLCByZXF1ZXN0KTtcclxuICAgIGlmICghZ2VvUmVzdWx0LmFsbG93ZWQpIHJldHVybiBnZW9SZXN1bHQ7XHJcbiAgICBcclxuICAgIC8vIEFwcGx5IHRoZSBtYWluIGFsZ29yaXRobVxyXG4gICAgc3dpdGNoIChydWxlLmFsZ29yaXRobSkge1xyXG4gICAgICBjYXNlICdzbGlkaW5nX3dpbmRvdyc6XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2xpZGluZ1dpbmRvd0NoZWNrKHJ1bGUsIGlkZW50aWZpZXIpO1xyXG4gICAgICBjYXNlICd0b2tlbl9idWNrZXQnOlxyXG4gICAgICAgIHJldHVybiB0aGlzLnRva2VuQnVja2V0Q2hlY2socnVsZSwgaWRlbnRpZmllcik7XHJcbiAgICAgIGNhc2UgJ2ZpeGVkX3dpbmRvdyc6XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZml4ZWRXaW5kb3dDaGVjayhydWxlLCBpZGVudGlmaWVyKTtcclxuICAgICAgY2FzZSAnYWRhcHRpdmUnOlxyXG4gICAgICAgIHJldHVybiB0aGlzLmFkYXB0aXZlQ2hlY2socnVsZSwgaWRlbnRpZmllciwgcmVxdWVzdCk7XHJcbiAgICAgIGNhc2UgJ2Rpc3RyaWJ1dGVkJzpcclxuICAgICAgICByZXR1cm4gdGhpcy5kaXN0cmlidXRlZENoZWNrKHJ1bGUsIGlkZW50aWZpZXIpO1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHJldHVybiB0aGlzLnNsaWRpbmdXaW5kb3dDaGVjayhydWxlLCBpZGVudGlmaWVyKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgY2hlY2tHbG9iYWxMaW1pdHMocmVxdWVzdDogUmF0ZUxpbWl0UmVxdWVzdCk6IFByb21pc2U8UmF0ZUxpbWl0UmVzdWx0PiB7XHJcbiAgICAvLyBDaGVjayBnbG9iYWwgSVAgbGltaXRcclxuICAgIGNvbnN0IGlwTGltaXQgPSB0aGlzLmdsb2JhbExpbWl0cy5nZXQoJ2lwX2dsb2JhbCcpO1xyXG4gICAgaWYgKGlwTGltaXQpIHtcclxuICAgICAgY29uc3Qgc3RvcmUgPSB0aGlzLmdldFN0b3JlKCdnbG9iYWxfaXAnKTtcclxuICAgICAgY29uc3QgcmVxdWVzdHMgPSBzdG9yZS5nZXRSZXF1ZXN0c0luV2luZG93KFxyXG4gICAgICAgIHJlcXVlc3QuaXAsXHJcbiAgICAgICAgRGF0ZS5ub3coKSAtIGlwTGltaXQud2luZG93LFxyXG4gICAgICAgIERhdGUubm93KClcclxuICAgICAgKTtcclxuICAgICAgXHJcbiAgICAgIGlmIChyZXF1ZXN0cy5sZW5ndGggPj0gaXBMaW1pdC5saW1pdCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBhbGxvd2VkOiBmYWxzZSxcclxuICAgICAgICAgIHJlYXNvbjogJ0dMT0JBTF9JUF9MSU1JVF9FWENFRURFRCcsXHJcbiAgICAgICAgICByZXNldFRpbWU6IERhdGUubm93KCkgKyBpcExpbWl0LndpbmRvdyxcclxuICAgICAgICAgIHJldHJ5QWZ0ZXI6IE1hdGguY2VpbChpcExpbWl0LndpbmRvdyAvIDEwMDApXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4geyBhbGxvd2VkOiB0cnVlIH07XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldFN0b3JlKG5hbWU6IHN0cmluZyk6IFJhdGVMaW1pdFN0b3JlIHtcclxuICAgIGlmICghdGhpcy5zdG9yZXMuaGFzKG5hbWUpKSB7XHJcbiAgICAgIHRoaXMuc3RvcmVzLnNldChuYW1lLCBuZXcgSW5NZW1vcnlSYXRlTGltaXRTdG9yZSgpKTtcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzLnN0b3Jlcy5nZXQobmFtZSkhO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyByZWNvcmRSZXF1ZXN0KGlkZW50aWZpZXI6IHN0cmluZywgcmVxdWVzdDogUmF0ZUxpbWl0UmVxdWVzdCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgLy8gUmVjb3JkIGluIGFsbCBhcHBsaWNhYmxlIHN0b3Jlc1xyXG4gICAgY29uc3QgcnVsZXMgPSB0aGlzLmdldFJ1bGVzRm9yUmVxdWVzdChyZXF1ZXN0KTtcclxuICAgIFxyXG4gICAgZm9yIChjb25zdCBydWxlIG9mIHJ1bGVzKSB7XHJcbiAgICAgIGNvbnN0IHN0b3JlID0gdGhpcy5nZXRTdG9yZShydWxlLm5hbWUpO1xyXG4gICAgICBzdG9yZS5yZWNvcmRSZXF1ZXN0KGlkZW50aWZpZXIsIERhdGUubm93KCkpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyBnZXRSZW1haW5pbmdDb3VudChydWxlczogUmF0ZUxpbWl0UnVsZVtdLCBpZGVudGlmaWVyOiBzdHJpbmcpOiBQcm9taXNlPG51bWJlcj4ge1xyXG4gICAgbGV0IG1pblJlbWFpbmluZyA9IEluZmluaXR5O1xyXG4gICAgXHJcbiAgICBmb3IgKGNvbnN0IHJ1bGUgb2YgcnVsZXMpIHtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5jaGVja1J1bGUocnVsZSwgaWRlbnRpZmllciwge30gYXMgUmF0ZUxpbWl0UmVxdWVzdCk7XHJcbiAgICAgIGlmIChyZXN1bHQucmVtYWluaW5nICE9PSB1bmRlZmluZWQgJiYgcmVzdWx0LnJlbWFpbmluZyA8IG1pblJlbWFpbmluZykge1xyXG4gICAgICAgIG1pblJlbWFpbmluZyA9IHJlc3VsdC5yZW1haW5pbmc7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIG1pblJlbWFpbmluZyA9PT0gSW5maW5pdHkgPyAwIDogbWluUmVtYWluaW5nO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhcHBseUxvYWRCYXNlZExpbWl0cyhmYWN0b3I6IG51bWJlcik6IHZvaWQge1xyXG4gICAgZm9yIChjb25zdCBbZW5kcG9pbnQsIHJ1bGVzXSBvZiB0aGlzLnJ1bGVzKSB7XHJcbiAgICAgIHJ1bGVzLmZvckVhY2gocnVsZSA9PiB7XHJcbiAgICAgICAgaWYgKCFydWxlLm9yaWdpbmFsTGltaXQpIHtcclxuICAgICAgICAgIHJ1bGUub3JpZ2luYWxMaW1pdCA9IHJ1bGUubGltaXQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJ1bGUubGltaXQgPSBNYXRoLmZsb29yKHJ1bGUub3JpZ2luYWxMaW1pdCAqIGZhY3Rvcik7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzdGFydENsZWFudXBUaW1lcigpOiB2b2lkIHtcclxuICAgIHNldEludGVydmFsKCgpID0+IHtcclxuICAgICAgdGhpcy5jbGVhbnVwKCk7XHJcbiAgICB9LCAzMDAwMDApOyAvLyA1IG1pbnV0ZXNcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY2xlYW51cCgpOiB2b2lkIHtcclxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcbiAgICBjb25zdCBjbGVhbnVwQWdlID0gMzYwMDAwMDsgLy8gMSBob3VyXHJcbiAgICBcclxuICAgIC8vIENsZWFuIHVwIG9sZCBzdXNwaWNpb3VzIGFjdGl2aXR5IHJlY29yZHNcclxuICAgIGZvciAoY29uc3QgW2lwLCBhY3Rpdml0eV0gb2YgdGhpcy5zdXNwaWNpb3VzQWN0aXZpdHkpIHtcclxuICAgICAgaWYgKG5vdyAtIGFjdGl2aXR5Lmxhc3RWaW9sYXRpb24gPiBjbGVhbnVwQWdlKSB7XHJcbiAgICAgICAgdGhpcy5zdXNwaWNpb3VzQWN0aXZpdHkuZGVsZXRlKGlwKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBDbGVhbiB1cCBzdG9yZSBkYXRhXHJcbiAgICBmb3IgKGNvbnN0IHN0b3JlIG9mIHRoaXMuc3RvcmVzLnZhbHVlcygpKSB7XHJcbiAgICAgIHN0b3JlLmNsZWFudXAoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIE1vY2sgaW1wbGVtZW50YXRpb25zIGZvciBleHRlcm5hbCBzZXJ2aWNlc1xyXG4gIHByaXZhdGUgYXN5bmMgZ2V0U3lzdGVtTG9hZCgpOiBQcm9taXNlPG51bWJlcj4ge1xyXG4gICAgcmV0dXJuIE1hdGgucmFuZG9tKCkgKiAxMDA7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGdldERhdGFiYXNlTG9hZCgpOiBQcm9taXNlPG51bWJlcj4ge1xyXG4gICAgcmV0dXJuIE1hdGgucmFuZG9tKCkgKiAxMDA7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGdldERpc3RyaWJ1dGVkU3RvcmUoKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIC8vIE1vY2sgUmVkaXMgY2xpZW50XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBwaXBlbGluZTogKCkgPT4gKHtcclxuICAgICAgICBpbmNyOiAoKSA9PiB7fSxcclxuICAgICAgICBleHBpcmU6ICgpID0+IHt9LFxyXG4gICAgICAgIGV4ZWM6ICgpID0+IFByb21pc2UucmVzb2x2ZShbW251bGwsIDFdXSlcclxuICAgICAgfSksXHJcbiAgICAgIHR0bDogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKDYwKVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgZ2V0VXNlclByb2ZpbGUoaWRlbnRpZmllcjogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHRpZXI6ICdmcmVlJyxcclxuICAgICAgcmVwdXRhdGlvbjogMC41XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyBnZXRJUExvY2F0aW9uKGlwOiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgY291bnRyeTogJ1VTJyxcclxuICAgICAgcmVnaW9uOiAnQ0EnXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuLy8gSW4tbWVtb3J5IHJhdGUgbGltaXQgc3RvcmUgaW1wbGVtZW50YXRpb25cclxuY2xhc3MgSW5NZW1vcnlSYXRlTGltaXRTdG9yZSBpbXBsZW1lbnRzIFJhdGVMaW1pdFN0b3JlIHtcclxuICBwcml2YXRlIHJlcXVlc3RzOiBNYXA8c3RyaW5nLCBudW1iZXJbXT4gPSBuZXcgTWFwKCk7XHJcbiAgcHJpdmF0ZSB3aW5kb3dDb3VudHM6IE1hcDxzdHJpbmcsIHsgY291bnQ6IG51bWJlcjsgZXhwaXJ5OiBudW1iZXIgfT4gPSBuZXcgTWFwKCk7XHJcbiAgcHJpdmF0ZSB0b2tlbkJ1Y2tldHM6IE1hcDxzdHJpbmcsIFRva2VuQnVja2V0PiA9IG5ldyBNYXAoKTtcclxuXHJcbiAgZ2V0UmVxdWVzdHNJbldpbmRvdyhpZGVudGlmaWVyOiBzdHJpbmcsIHdpbmRvd1N0YXJ0OiBudW1iZXIsIHdpbmRvd0VuZDogbnVtYmVyKTogbnVtYmVyW10ge1xyXG4gICAgY29uc3QgcmVxdWVzdHMgPSB0aGlzLnJlcXVlc3RzLmdldChpZGVudGlmaWVyKSB8fCBbXTtcclxuICAgIHJldHVybiByZXF1ZXN0cy5maWx0ZXIodGltZSA9PiB0aW1lID49IHdpbmRvd1N0YXJ0ICYmIHRpbWUgPD0gd2luZG93RW5kKTtcclxuICB9XHJcblxyXG4gIHJlY29yZFJlcXVlc3QoaWRlbnRpZmllcjogc3RyaW5nLCB0aW1lc3RhbXA6IG51bWJlcik6IHZvaWQge1xyXG4gICAgaWYgKCF0aGlzLnJlcXVlc3RzLmhhcyhpZGVudGlmaWVyKSkge1xyXG4gICAgICB0aGlzLnJlcXVlc3RzLnNldChpZGVudGlmaWVyLCBbXSk7XHJcbiAgICB9XHJcbiAgICB0aGlzLnJlcXVlc3RzLmdldChpZGVudGlmaWVyKSEucHVzaCh0aW1lc3RhbXApO1xyXG4gIH1cclxuXHJcbiAgZ2V0V2luZG93Q291bnQod2luZG93S2V5OiBzdHJpbmcpOiBudW1iZXIge1xyXG4gICAgY29uc3QgZW50cnkgPSB0aGlzLndpbmRvd0NvdW50cy5nZXQod2luZG93S2V5KTtcclxuICAgIGlmICghZW50cnkgfHwgRGF0ZS5ub3coKSA+IGVudHJ5LmV4cGlyeSkge1xyXG4gICAgICByZXR1cm4gMDtcclxuICAgIH1cclxuICAgIHJldHVybiBlbnRyeS5jb3VudDtcclxuICB9XHJcblxyXG4gIGluY3JlbWVudFdpbmRvd0NvdW50KHdpbmRvd0tleTogc3RyaW5nLCB3aW5kb3dEdXJhdGlvbjogbnVtYmVyKTogdm9pZCB7XHJcbiAgICBjb25zdCBlbnRyeSA9IHRoaXMud2luZG93Q291bnRzLmdldCh3aW5kb3dLZXkpIHx8IHsgY291bnQ6IDAsIGV4cGlyeTogMCB9O1xyXG4gICAgZW50cnkuY291bnQrKztcclxuICAgIGVudHJ5LmV4cGlyeSA9IERhdGUubm93KCkgKyB3aW5kb3dEdXJhdGlvbjtcclxuICAgIHRoaXMud2luZG93Q291bnRzLnNldCh3aW5kb3dLZXksIGVudHJ5KTtcclxuICB9XHJcblxyXG4gIGdldFRva2VuQnVja2V0KGlkZW50aWZpZXI6IHN0cmluZyk6IFRva2VuQnVja2V0IHwgbnVsbCB7XHJcbiAgICByZXR1cm4gdGhpcy50b2tlbkJ1Y2tldHMuZ2V0KGlkZW50aWZpZXIpIHx8IG51bGw7XHJcbiAgfVxyXG5cclxuICBzZXRUb2tlbkJ1Y2tldChpZGVudGlmaWVyOiBzdHJpbmcsIGJ1Y2tldDogVG9rZW5CdWNrZXQpOiB2b2lkIHtcclxuICAgIHRoaXMudG9rZW5CdWNrZXRzLnNldChpZGVudGlmaWVyLCBidWNrZXQpO1xyXG4gIH1cclxuXHJcbiAgZ2V0U3RhdGlzdGljcyh0aW1lUmFuZ2U6IHN0cmluZyk6IGFueSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB0b3RhbFJlcXVlc3RzOiAwLFxyXG4gICAgICBibG9ja2VkUmVxdWVzdHM6IDBcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBjbGVhbnVwKCk6IHZvaWQge1xyXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcclxuICAgIGNvbnN0IGNsZWFudXBBZ2UgPSAzNjAwMDAwOyAvLyAxIGhvdXJcclxuICAgIFxyXG4gICAgLy8gQ2xlYW4gdXAgb2xkIHJlcXVlc3RzXHJcbiAgICBmb3IgKGNvbnN0IFtpZGVudGlmaWVyLCByZXF1ZXN0c10gb2YgdGhpcy5yZXF1ZXN0cykge1xyXG4gICAgICBjb25zdCBmaWx0ZXJlZCA9IHJlcXVlc3RzLmZpbHRlcih0aW1lID0+IG5vdyAtIHRpbWUgPCBjbGVhbnVwQWdlKTtcclxuICAgICAgaWYgKGZpbHRlcmVkLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIHRoaXMucmVxdWVzdHMuZGVsZXRlKGlkZW50aWZpZXIpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMucmVxdWVzdHMuc2V0KGlkZW50aWZpZXIsIGZpbHRlcmVkKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBDbGVhbiB1cCBleHBpcmVkIHdpbmRvdyBjb3VudHNcclxuICAgIGZvciAoY29uc3QgW3dpbmRvd0tleSwgZW50cnldIG9mIHRoaXMud2luZG93Q291bnRzKSB7XHJcbiAgICAgIGlmIChub3cgPiBlbnRyeS5leHBpcnkpIHtcclxuICAgICAgICB0aGlzLndpbmRvd0NvdW50cy5kZWxldGUod2luZG93S2V5KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuLy8gVHlwZSBkZWZpbml0aW9uc1xyXG5pbnRlcmZhY2UgUmF0ZUxpbWl0UmVxdWVzdCB7XHJcbiAgaXA6IHN0cmluZztcclxuICB1c2VySWQ/OiBzdHJpbmc7XHJcbiAgZW5kcG9pbnQ6IHN0cmluZztcclxuICBtZXRob2Q6IHN0cmluZztcclxuICB1c2VyQWdlbnQ/OiBzdHJpbmc7XHJcbiAgaGVhZGVycz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XHJcbn1cclxuXHJcbmludGVyZmFjZSBSYXRlTGltaXRSdWxlIHtcclxuICBuYW1lOiBzdHJpbmc7XHJcbiAgZW5kcG9pbnQ/OiBzdHJpbmc7XHJcbiAgbGltaXQ6IG51bWJlcjtcclxuICB3aW5kb3c6IG51bWJlcjsgLy8gbWlsbGlzZWNvbmRzXHJcbiAgYWxnb3JpdGhtOiAnc2xpZGluZ193aW5kb3cnIHwgJ3Rva2VuX2J1Y2tldCcgfCAnZml4ZWRfd2luZG93JyB8ICdhZGFwdGl2ZScgfCAnZGlzdHJpYnV0ZWQnO1xyXG4gIHByaW9yaXR5PzogbnVtYmVyO1xyXG4gIG9yaWdpbmFsTGltaXQ/OiBudW1iZXI7XHJcbiAgZGlzdHJpYnV0ZWQ/OiBib29sZWFuO1xyXG4gIGJ1cnN0UHJvdGVjdGlvbj86IHtcclxuICAgIGxpbWl0OiBudW1iZXI7XHJcbiAgICB3aW5kb3c6IG51bWJlcjtcclxuICB9O1xyXG4gIGdlb2dyYXBoaWM/OiBSZWNvcmQ8c3RyaW5nLCB7IGxpbWl0PzogbnVtYmVyOyB3aW5kb3c/OiBudW1iZXIgfT47XHJcbn1cclxuXHJcbmludGVyZmFjZSBSYXRlTGltaXRSZXN1bHQge1xyXG4gIGFsbG93ZWQ6IGJvb2xlYW47XHJcbiAgcmVhc29uPzogc3RyaW5nO1xyXG4gIHJlbWFpbmluZz86IG51bWJlcjtcclxuICByZXNldFRpbWU/OiBudW1iZXI7XHJcbiAgcmV0cnlBZnRlcj86IG51bWJlcjtcclxuICBsaW1pdD86IG51bWJlcjtcclxufVxyXG5cclxuaW50ZXJmYWNlIFJhdGVMaW1pdFN0b3JlIHtcclxuICBnZXRSZXF1ZXN0c0luV2luZG93KGlkZW50aWZpZXI6IHN0cmluZywgd2luZG93U3RhcnQ6IG51bWJlciwgd2luZG93RW5kOiBudW1iZXIpOiBudW1iZXJbXTtcclxuICByZWNvcmRSZXF1ZXN0KGlkZW50aWZpZXI6IHN0cmluZywgdGltZXN0YW1wOiBudW1iZXIpOiB2b2lkO1xyXG4gIGdldFdpbmRvd0NvdW50KHdpbmRvd0tleTogc3RyaW5nKTogbnVtYmVyO1xyXG4gIGluY3JlbWVudFdpbmRvd0NvdW50KHdpbmRvd0tleTogc3RyaW5nLCB3aW5kb3dEdXJhdGlvbjogbnVtYmVyKTogdm9pZDtcclxuICBnZXRUb2tlbkJ1Y2tldChpZGVudGlmaWVyOiBzdHJpbmcpOiBUb2tlbkJ1Y2tldCB8IG51bGw7XHJcbiAgc2V0VG9rZW5CdWNrZXQoaWRlbnRpZmllcjogc3RyaW5nLCBidWNrZXQ6IFRva2VuQnVja2V0KTogdm9pZDtcclxuICBnZXRTdGF0aXN0aWNzKHRpbWVSYW5nZTogc3RyaW5nKTogYW55O1xyXG4gIGNsZWFudXAoKTogdm9pZDtcclxufVxyXG5cclxuaW50ZXJmYWNlIFRva2VuQnVja2V0IHtcclxuICB0b2tlbnM6IG51bWJlcjtcclxuICBsYXN0UmVmaWxsOiBudW1iZXI7XHJcbn1cclxuXHJcbmludGVyZmFjZSBHbG9iYWxMaW1pdCB7XHJcbiAgbGltaXQ6IG51bWJlcjtcclxuICB3aW5kb3c6IG51bWJlcjtcclxufVxyXG5cclxuaW50ZXJmYWNlIFN1c3BpY2lvdXNBY3Rpdml0eSB7XHJcbiAgdmlvbGF0aW9uczogbnVtYmVyO1xyXG4gIGZpcnN0VmlvbGF0aW9uOiBudW1iZXI7XHJcbiAgbGFzdFZpb2xhdGlvbjogbnVtYmVyO1xyXG4gIHJ1bGVzOiBTZXQ8c3RyaW5nPjtcclxufVxyXG5cclxuaW50ZXJmYWNlIFJhdGVMaW1pdFN0YXRpc3RpY3Mge1xyXG4gIHRvdGFsUmVxdWVzdHM6IG51bWJlcjtcclxuICBibG9ja2VkUmVxdWVzdHM6IG51bWJlcjtcclxuICB0b3BCbG9ja2VkSVBzOiBBcnJheTx7IGlwOiBzdHJpbmc7IGNvdW50OiBudW1iZXIgfT47XHJcbiAgdG9wQmxvY2tlZEVuZHBvaW50czogQXJyYXk8eyBlbmRwb2ludDogc3RyaW5nOyBjb3VudDogbnVtYmVyIH0+O1xyXG4gIHJ1bGVzOiBBcnJheTx7IG5hbWU6IHN0cmluZzsgW2tleTogc3RyaW5nXTogYW55IH0+O1xyXG59XHJcblxyXG4vLyBFeHBvcnQgc2luZ2xldG9uIGluc3RhbmNlXHJcbmV4cG9ydCBjb25zdCBhZHZhbmNlZFJhdGVMaW1pdGVyID0gbmV3IEFkdmFuY2VkUmF0ZUxpbWl0ZXIoKTsiXSwibmFtZXMiOlsiQWR2YW5jZWRSYXRlTGltaXRlciIsImFkdmFuY2VkUmF0ZUxpbWl0ZXIiLCJFdmVudEVtaXR0ZXIiLCJzdG9yZXMiLCJNYXAiLCJydWxlcyIsImdsb2JhbExpbWl0cyIsIndoaXRlbGlzdGVkSVBzIiwiU2V0IiwiYmxhY2tsaXN0ZWRJUHMiLCJzdXNwaWNpb3VzQWN0aXZpdHkiLCJpbml0aWFsaXplRGVmYXVsdFJ1bGVzIiwic3RhcnRDbGVhbnVwVGltZXIiLCJjaGVja0xpbWl0IiwicmVxdWVzdCIsImlkZW50aWZpZXIiLCJnZXRJZGVudGlmaWVyIiwiaGFzIiwiaXAiLCJhbGxvd2VkIiwicmVhc29uIiwicmVzZXRUaW1lIiwiRGF0ZSIsIm5vdyIsInJldHJ5QWZ0ZXIiLCJyZW1haW5pbmciLCJJbmZpbml0eSIsImdldFJ1bGVzRm9yUmVxdWVzdCIsInJ1bGUiLCJyZXN1bHQiLCJjaGVja1J1bGUiLCJ0cmFja1N1c3BpY2lvdXNBY3Rpdml0eSIsImVtaXQiLCJuYW1lIiwiZ2xvYmFsUmVzdWx0IiwiY2hlY2tHbG9iYWxMaW1pdHMiLCJyZWNvcmRSZXF1ZXN0IiwiZ2V0UmVtYWluaW5nQ291bnQiLCJNYXRoIiwibWluIiwibWFwIiwiciIsIndpbmRvdyIsImFkZFJ1bGUiLCJlbmRwb2ludCIsInNldCIsImdldCIsInB1c2giLCJzb3J0IiwiYSIsImIiLCJwcmlvcml0eSIsImFkanVzdExpbWl0c0Jhc2VkT25Mb2FkIiwic3lzdGVtTG9hZCIsImdldFN5c3RlbUxvYWQiLCJkYkxvYWQiLCJnZXREYXRhYmFzZUxvYWQiLCJhcHBseUxvYWRCYXNlZExpbWl0cyIsImZhY3RvciIsInNsaWRpbmdXaW5kb3dDaGVjayIsInN0b3JlIiwiZ2V0U3RvcmUiLCJ3aW5kb3dTdGFydCIsInJlcXVlc3RzIiwiZ2V0UmVxdWVzdHNJbldpbmRvdyIsImxlbmd0aCIsImxpbWl0Iiwib2xkZXN0UmVxdWVzdCIsImNlaWwiLCJ0b2tlbkJ1Y2tldENoZWNrIiwiYnVja2V0IiwiZ2V0VG9rZW5CdWNrZXQiLCJ0b2tlbnMiLCJsYXN0UmVmaWxsIiwidGltZVBhc3NlZCIsInRva2Vuc1RvQWRkIiwiZmxvb3IiLCJyZWZpbGxUaW1lIiwic2V0VG9rZW5CdWNrZXQiLCJmaXhlZFdpbmRvd0NoZWNrIiwid2luZG93S2V5IiwiY291bnQiLCJnZXRXaW5kb3dDb3VudCIsImluY3JlbWVudFdpbmRvd0NvdW50IiwiZGlzdHJpYnV0ZWRDaGVjayIsImRpc3RyaWJ1dGVkIiwiRXJyb3IiLCJkaXN0cmlidXRlZFN0b3JlIiwiZ2V0RGlzdHJpYnV0ZWRTdG9yZSIsImtleSIsInBpcGVsaW5lIiwiaW5jciIsImV4cGlyZSIsInJlc3VsdHMiLCJleGVjIiwidHRsIiwiYWRhcHRpdmVDaGVjayIsInVzZXJQcm9maWxlIiwiZ2V0VXNlclByb2ZpbGUiLCJhZGp1c3RlZExpbWl0IiwidGllciIsInJlcHV0YXRpb24iLCJhZGp1c3RlZFJ1bGUiLCJnZW9ncmFwaGljQ2hlY2siLCJnZW9ncmFwaGljIiwibG9jYXRpb24iLCJnZXRJUExvY2F0aW9uIiwiZ2VvUnVsZSIsImNvdW50cnkiLCJkZWZhdWx0IiwiYnVyc3RQcm90ZWN0aW9uQ2hlY2siLCJidXJzdFByb3RlY3Rpb24iLCJidXJzdFdpbmRvdyIsImJ1cnN0TGltaXQiLCJyZWNlbnRSZXF1ZXN0cyIsImFkZFRvV2hpdGVsaXN0IiwiYWRkIiwicmVtb3ZlRnJvbVdoaXRlbGlzdCIsImRlbGV0ZSIsImFkZFRvQmxhY2tsaXN0IiwiZHVyYXRpb24iLCJzZXRUaW1lb3V0IiwicmVtb3ZlRnJvbUJsYWNrbGlzdCIsImFjdGl2aXR5IiwidmlvbGF0aW9ucyIsImZpcnN0VmlvbGF0aW9uIiwibGFzdFZpb2xhdGlvbiIsImdldFN0YXRpc3RpY3MiLCJ0aW1lUmFuZ2UiLCJzdGF0cyIsInRvdGFsUmVxdWVzdHMiLCJibG9ja2VkUmVxdWVzdHMiLCJ0b3BCbG9ja2VkSVBzIiwidG9wQmxvY2tlZEVuZHBvaW50cyIsInJ1bGVOYW1lIiwicnVsZVN0YXRzIiwiYWxnb3JpdGhtIiwidXNlcklkIiwibWF0Y2hpbmdSdWxlcyIsImVuZHBvaW50TWF0Y2hlcyIsInBhdHRlcm4iLCJyZWdleCIsIlJlZ0V4cCIsInJlcGxhY2UiLCJ0ZXN0IiwiYnVyc3RSZXN1bHQiLCJnZW9SZXN1bHQiLCJpcExpbWl0IiwiSW5NZW1vcnlSYXRlTGltaXRTdG9yZSIsIm1pblJlbWFpbmluZyIsInVuZGVmaW5lZCIsImZvckVhY2giLCJvcmlnaW5hbExpbWl0Iiwic2V0SW50ZXJ2YWwiLCJjbGVhbnVwIiwiY2xlYW51cEFnZSIsInZhbHVlcyIsInJhbmRvbSIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVnaW9uIiwid2luZG93RW5kIiwiZmlsdGVyIiwidGltZSIsInRpbWVzdGFtcCIsImVudHJ5Iiwid2luZG93Q291bnRzIiwiZXhwaXJ5Iiwid2luZG93RHVyYXRpb24iLCJ0b2tlbkJ1Y2tldHMiLCJmaWx0ZXJlZCJdLCJtYXBwaW5ncyI6IkFBQUEsY0FBYzs7Ozs7Ozs7Ozs7O1FBSURBO2VBQUFBOztRQXd2QkFDO2VBQUFBOzs7d0JBM3ZCZ0I7QUFHdEIsTUFBTUQsNEJBQTRCRSxvQkFBWTtJQVFuRCxhQUFjO1FBQ1osS0FBSyxTQVJDQyxTQUFzQyxJQUFJQyxZQUMxQ0MsUUFBc0MsSUFBSUQsWUFDMUNFLGVBQXlDLElBQUlGLFlBQzdDRyxpQkFBOEIsSUFBSUMsWUFDbENDLGlCQUE4QixJQUFJRCxZQUNsQ0UscUJBQXNELElBQUlOO1FBSWhFLElBQUksQ0FBQ08sc0JBQXNCO1FBQzNCLElBQUksQ0FBQ0MsaUJBQWlCO0lBQ3hCO0lBRUEsOEJBQThCO0lBQzlCLE1BQU1DLFdBQVdDLE9BQXlCLEVBQTRCO1FBQ3BFLE1BQU1DLGFBQWEsSUFBSSxDQUFDQyxhQUFhLENBQUNGO1FBRXRDLHdCQUF3QjtRQUN4QixJQUFJLElBQUksQ0FBQ0wsY0FBYyxDQUFDUSxHQUFHLENBQUNILFFBQVFJLEVBQUUsR0FBRztZQUN2QyxPQUFPO2dCQUNMQyxTQUFTO2dCQUNUQyxRQUFRO2dCQUNS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